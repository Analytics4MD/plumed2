UNITS NATURAL

dens: COORDINATIONNUMBER SPECIESA=2 SPECIESB=3-5 SWITCH={RATIONAL D_0=1.1 R_0=0.001 D_MAX=2.0}  

# Print the average (whole trajectory) density with a stride of one 
dens1: MULTICOLVARDENS DATA=dens ORIGIN=1 DIR=x GRID_BIN=50 NORMALIZATION=false BANDWIDTH=0.2 
PRINT ARG=dens1_numer STRIDE=1 FILE=numer_dens1.grid FMT=%8.4f
PRINT ARG=dens1 STRIDE=1 FILE=dens1.grid FMT=%8.4f
# Print the average density with a stride of two 
PRINT ARG=dens1_numer STRIDE=2 FILE=dens2.grid FMT=%8.4f
# Print the average density (whole trajectory)
PRINT ARG=dens1_numer FILE=dens5.grid FMT=%8.4f

# Print the average (whole trajectory) density with a stride of one 
dens1a: MULTICOLVARDENS DATA=dens ORIGIN=1 DIR=x GRID_BIN=50 BANDWIDTH=0.2
PRINT ARG=dens1a FILE=dens5a.grid FMT=%8.4f

# Print unormalized averages (over two frames) of the density
dens1b: MULTICOLVARDENS DATA=dens ORIGIN=1 DIR=x GRID_BIN=50 CLEAR=1 NORMALIZATION=false BANDWIDTH=0.2
PRINT ARG=dens1b_numer STRIDE=1 FILE=dens1b.grid FMT=%8.4f

# Print block averages (over two frames) of the density
dens1ba: MULTICOLVARDENS DATA=dens ORIGIN=1 DIR=x GRID_BIN=50 CLEAR=1 BANDWIDTH=0.2
PRINT ARG=dens1ba STRIDE=1 FILE=dens1ba.grid FMT=%8.4f

# Interpolate onto a finer grid and test
fine: MULTICOLVARDENS DATA=dens ORIGIN=1 DIR=x GRID_BIN=100 BANDWIDTH=0.1
interpol_g: INTERPOLATE_GRID ARG=dens1a GRID_BIN=100
interpol: AVERAGE ARG=interpol_g STRIDE=2

PRINT ARG=fine FILE=fine_grid.grid FMT=%8.4f
PRINT ARG=interpol FILE=interpol.grid FMT=%8.4f
